<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Atturaif - Shop</title>
        <meta name="description" content="Atturaif is An Interactive Tour Guide Application and has an Admin website for management">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- Google Fonts -->
        <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
        <script>
          WebFont.load({
            google: {"families":["Montserrat:400,500,600,700","Noto+Sans:400,700"]},
            active: function() {
                sessionStorage.fonts = true;
            }
          });
        </script>
        <!-- Favicon -->
        <link rel="apple-touch-icon" sizes="180x180" href="assets/img/logo.png">
        <link rel="icon" type="image/png" sizes="32x32" href="assets/img/logo-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="assets/img/logo-16x16.png">
        <!-- Stylesheet -->
        <link rel="stylesheet" href="assets/vendors/css/base/bootstrap.min.css">
        <link rel="stylesheet" href="assets/vendors/css/base/elisyam-1.5.min.css">
        
    </head>
    <body id="page-top">
        <!-- Begin Preloader -->
        <div id="preloader">
            <div class="canvas">
                <img src="assets/img/logo.png" alt="logo" class="loader-logo">
                <div class="spinner"></div>   
            </div>
        </div>
        <!-- End Preloader -->
        <div class="page">
            <!-- Begin Header -->
            <header class="header">
                <nav class="navbar fixed-top">         
                   
                    <!-- Begin Topbar -->
                    <div class="navbar-holder d-flex align-items-center align-middle justify-content-between">
                        <!-- Begin Logo -->
                        <div class="navbar-header">
                            <a href="index.html" class="navbar-brand">
                                <div class="brand-image brand-big">
                                    <img src="assets/img/logo.png" alt="logo" style="width: 70px;" class="logo-big">
                                </div>
                                <div class="brand-image brand-small">
                                    <img src="assets/img/logo.png" alt="logo" class="logo-small">
                                </div>
                            </a>
                            <!-- Toggle Button -->
                            <a id="toggle-btn" href="#" class="menu-btn active">
                                <span></span>
                                <span></span>
                                <span></span>
                            </a>
                            <!-- End Toggle -->
                        </div>
                        <!-- End Logo -->
                    </div>
                    <!-- End Topbar -->
                </nav>
            </header>
            <!-- End Header -->
            <!-- Begin Page Content -->
            <div class="page-content d-flex align-items-stretch">
               
                <div class="content-inner">
                    <div class="container-fluid">
                        <!-- Begin Page Header-->
                        <div class="row">
                            <div class="page-header">
	                            <div class="d-flex align-items-center">
	                                <h2 class="page-header-title">Edit Shop</h2>
	                                <div>
			                            <ul class="breadcrumb">
			                                <li class="breadcrumb-item"><a href="index.html"><i class="ti ti-home"></i></a></li>
			                                <li class="breadcrumb-item"><a href="pages-shops.html">Shops</a></li>
			                            </ul>
	                                </div>
	                            </div>
                            </div>
                        </div>
                        <!-- End Page Header -->
                        <div class="row flex-row">
                            <div class="col-xl-12">
                                <!-- Form -->
                                <div class="widget has-shadow">
                                    <div class="widget-header bordered no-actions d-flex align-items-center">
                                        <h4>Shop Form</h4>
                                    </div>
                                    <div class="widget-body">
                                        <form class="needs-validation" novalidate>

                                            <div class="form-group row d-flex align-items-center mb-5">
                                                <label class="col-lg-4 form-control-label d-flex justify-content-lg-end">Shop Number</label>
                                                <div class="col-lg-5">
                                                    <input type="text" id="numshop" class="form-control" placeholder="أدخل رقم السوق" required>
                                                </div>
                                            </div>
                                            <div class="form-group row d-flex align-items-center mb-5">
                                                <label class="col-lg-4 form-control-label d-flex justify-content-lg-end">Arabic Name</label>
                                                <div class="col-lg-5">
                                                    <input type="text" id="aname" class="form-control" placeholder="أدخل أسم السوق" required>
                                                </div>
                                            </div>
                                            <div class="form-group row d-flex align-items-center mb-5">
                                                <label class="col-lg-4 form-control-label d-flex justify-content-lg-end">English Name</label>
                                                <div class="col-lg-5">
                                                    <input type="text" id="ename" class="form-control" placeholder="Enter Shop name" required>
                                                </div>
                                            </div>
                                              <!-- Time -->
                                        <div class="form-group row d-flex align-items-center mb-5">
                                            <label class="col-lg-4 form-control-label d-flex justify-content-lg-end">Start Date Name</label>
                                            <div class="col-lg-5">
                                                <input type="text" id="stday" class="form-control" placeholder="Enter the Start Date Name" required>
                                            </div>
                                        </div>
                                         
                                        <div class="form-group row d-flex align-items-center mb-5">
                                            <label class="col-lg-4 form-control-label d-flex justify-content-lg-end"> Time for the Start Date</label>
                                            <div class="col-lg-5">
                                                <input type="text" id="sttime" class="form-control" placeholder="EX: 9:15 AM - 5:00 PM" required>
                                            </div>
                                        </div>

                                        <div class="form-group row d-flex align-items-center mb-5">
                                            <label class="col-lg-4 form-control-label d-flex justify-content-lg-end">End Date Name</label>
                                            <div class="col-lg-5">
                                                <input type="text" id="endday" class="form-control" placeholder="If there was a onther working day">
                                            </div>
                                        </div>
                                        
                                        <div class="form-group row d-flex align-items-center mb-5">
                                            <label class="col-lg-4 form-control-label d-flex justify-content-lg-end">Time for the End Date</label>
                                            <div class="col-lg-5">
                                                <input type="text" id="endtime" class="form-control" placeholder="EX: 9:15 AM - 5:00 PM" >
                                            </div>
                                        </div>
                                        <!--end time-->
                                            
                                            
                                            <div class="form-group row d-flex align-items-center mb-5">
                                                <label class="col-lg-4 form-control-label d-flex justify-content-lg-end">Arabic Shop Description</label>
                                                <div class="col-lg-5">
                                                    <textarea id="ardes" class="form-control" placeholder="أدخل تعريف بالعربي هنا ..." required></textarea>
                                                    <div class="invalid-feedback">
                                                        Please enter an Arabic description for the shop
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group row d-flex align-items-center mb-5">
                                                    <label class="col-lg-4 form-control-label d-flex justify-content-lg-end">English Shop Description</label>
                                                    <div class="col-lg-5">
                                                        <textarea id="endes" class="form-control" placeholder="Type english shop description here ..." required></textarea>
                                                        <div class="invalid-feedback">
                                                            Please enter an English description for the shop
                                                        </div>
                                                    </div>
                                                </div>
                                            <div class="form-group row d-flex align-items-center mb-5">
                                                <label class="col-lg-4 form-control-label d-flex justify-content-lg-end">Shop Image</label>
                                                <div class="col-lg-5">
                                                    <input type="file" id="fileButton" accept="image/*" placeholder="upload image" required>
                                                    <div class="invalid-feedback">
                                                        Please enter the image for the shop
                                                    </div>
                                                    
                                                </div>
                                            </div>
                                            
                                            <div class="text-right">
                                                <a href="#" onclick="sub()"> <button class="btn btn-gradient-01" type="submit">Save Changes</button></a>
                                                <button class="btn btn-shadow" type="reset">Reset</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <!-- End Form -->
                            </div>
                        </div>
                        <!-- End Row -->
                    </div>
                    <!-- End Container -->
                    
                    <a href="#" class="go-top"><i class="la la-arrow-up"></i></a>
                   
                </div>
            </div>
            <!-- End Page Content -->
        </div>
        <!-- Begin Vendor Js -->
        <script src="assets/vendors/js/base/jquery.min.js"></script>
        <script src="assets/vendors/js/base/core.min.js"></script>
        <!-- End Vendor Js -->
        <!-- Begin Page Vendor Js -->
        <script src="assets/vendors/js/nicescroll/nicescroll.min.js"></script>
        <script src="assets/vendors/js/app/app.min.js"></script>
        <!-- End Page Vendor Js -->
        <!-- Begin Page Snippets -->
        <script src="assets/js/components/validation/validation.min.js"></script>
        <!-- End Page Snippets -->
        
       <!--Date jQuery-->

       <!-- Begin Page Vendor Js -->
       <script src="assets/vendors/js/datepicker/moment.min.js"></script>
       <script src="assets/vendors/js/datepicker/daterangepicker.js"></script>
       <!-- End Page Vendor Js -->
       <!-- Begin Page Snippets -->
       <script src="assets/js/components/datepicker/datepicker.js"></script>
      <script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>
    
<script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-database.js"></script>
            <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-storage.js"></script>

<script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-auth.js"></script>


<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyCeyIbiJJVpSxhjkkVYt7S0I9zJ_wZoii4",
    authDomain: "atturaifsystem.firebaseapp.com",
    databaseURL: "https://atturaifsystem.firebaseio.com",
    projectId: "atturaifsystem",
    storageBucket: "atturaifsystem.appspot.com",
    messagingSenderId: "634716072857",
    appId: "1:634716072857:web:0c0d748300f4f335444108",
    measurementId: "G-ZHTNVKE6JM"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
</script>
<script>
    

    //view data 
    var arname = document.getElementById('numshop').value = localStorage.getItem('key');
    var arname = document.getElementById('aname').value = localStorage.getItem('shopnameAR');
    var enname = document.getElementById('ename').value = localStorage.getItem('shopnameEN');
   //time
    var stday = document.getElementById('stday').value = localStorage.getItem('days');
   // var sttime = document.getElementById('sttime').value = localStorage.getItem('');
    //var endday = document.getElementById('endday').value = localStorage.getItem('');
    //var endtime = document.getElementById('endtime').value = localStorage.getItem('');
    //end time
    var ardesc = document.getElementById('ardes').value = localStorage.getItem('DescriptionAR');
    var endesc = document.getElementById('endes').value = localStorage.getItem('DescriptionEN');
    //image missimng image
    var image = document.getElementById('fileButton').value = localStorage.getItem('image');


    // sub
    function sub() {

        var arname = document.getElementById('aname').value;
        var enname = document.getElementById('ename').value;
        var ardesc = document.getElementById('ardes').value;
        var endesc = document.getElementById('endes').value;
        var fileButton = document.getElementById('fileButton');
        //----time
        var startday = document.getElementById('stday').value;
        var endday = document.getElementById('endday').value;
        var starttime = document.getElementById('sttime').value;
        var starttime_1;
        var starttime_2;
        var endtime = document.getElementById('endtime').value;
        var endtime_1;
        var endtime_2;
        //---- end time var
        var numshop = document.getElementById('numshop').value;
        //------- start day --> time (start - end)


        originalString = starttime;
        separatedArray = [];

        // index of end of the last string  
        let previousIndex = 0;

        for (i = 0; i < originalString.length; i++) {

            // check the character for a comma 
            if (originalString[i] == '-') {

                // split the string from the last index 
                // to the comma 
                separated = originalString.slice(previousIndex, i);
                separatedArray.push(separated);

                // update the index of the last string 
                previousIndex = i + 1;
            }
        }
        // push the last string into the array 
        separatedArray.push(originalString.slice(previousIndex, i));

        starttime_1 = separatedArray[0];
        starttime_2 = separatedArray[1];





        //-------- end day --> time (start - end)

        originalString1 = endtime;
        separatedArray1 = [];

        // index of end of the last string  
        let previousIndex1 = 0;

        for (i = 0; i < originalString1.length; i++) {

            // check the character for a comma 
            if (originalString1[i] == '-') {

                // split the string from the last index 
                // to the comma 
                separated1 = originalString1.slice(previousIndex1, i);
                separatedArray1.push(separated1);

                // update the index of the last string 
                previousIndex1 = i + 1;
            }
        }
        // push the last string into the array 
        separatedArray1.push(originalString1.slice(previousIndex1, i));

        endtime_1 = separatedArray1[0];
        endtime_2 = separatedArray1[1];





        //--------- end time calculation


       

        savedata(numshop, arname, enname, ardesc, endesc, startday, starttime_1, starttime_2, endday, endtime_1, endtime_2);

    } //end sub


   
       
        

      //  fileButton.addEventListener('change', function (e) {
           
      //  });

    var linkref = firebase.database().ref('Shops');

    function savedata(numshop, arname, enname, ardesc, endesc, startday, starttime_1, starttime_2, endday, endtime_1, endtime_2) {
        var file = fileButton.files[0];
        linkref.child(parseInt(numshop)).set({
            shopnameAR: arname,
            shopnameEN: enname,
            DescriptionAR: ardesc,
            DescriptionEN: endesc,
            image: file.name
        });

        var linkref2 = linkref.child(parseInt(numshop)).child('days');
        //1
        linkref2.child(startday).set({
            openTime: starttime_1,
            closeTime: starttime_2
        });
        //2
        if (endday != "") {
            linkref2.child(endday).set({
                openTime: endtime_1,
                closeTime: endtime_2
            });
        }
      
        var file = e.target.files[0];
            firebase.storage().ref('shops').put(file);
        

    }


</script>
        </body>
        
        </html>